<!DOCTYPE html>
<html lang="zh-CN" id="htmlRoot">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title id="pageTitle">服务条款 - pptsize</title>
    <meta name="description" content="pptsize服务条款和使用协议" id="pageDescription">
    <meta name="robots" content="index, follow">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <!-- 样式 -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/legal.css">
    <link rel="stylesheet" href="css/auth.css">
</head>
<body>
    <!-- 导航栏容器 -->
    <div id="navbarContainer"></div>

    <!-- 主内容区 -->
    <div id="app">
        <!-- 法律页面容器 -->
        <div id="legalContainer"></div>
    </div>

    <!-- 页脚容器 -->
    <div id="footerContainer"></div>

    <!-- 1. 加载第三方库 -->
    <script src="js/config/supabase-js@2.js"></script>
    <script src="js/utils/axios.min.js"></script>

    <!-- 2. 加载国际化工具 -->
    <script src="js/utils/i18n.js"></script>
    
    <!-- 3. 加载语言包 -->
    <script src="js/lang/zh.js"></script>
    <script src="js/lang/en.js"></script>
    <script src="js/lang/ja.js"></script>
    <script src="js/lang/ko.js"></script>
    <script src="js/lang/hi.js"></script>
    <script src="js/lang/de.js"></script>
    <script src="js/lang/fr.js"></script>
    <script src="js/lang/es.js"></script>
    <script>
        // 使用 i18n 获取当前语言并设置全局语言对象
        const currentLang = window.i18n.getCurrentLangCode();
        window.LANG = window.i18n.loadLanguage(currentLang);
        
        // 动态设置页面标题和描述
        if (window.LANG && window.LANG.terms) {
            const pageTitle = window.LANG.terms.pageTitle || '服务条款';
            document.getElementById('pageTitle').textContent = `${pageTitle} - pptsize`;
            
            const metaDescription = window.LANG.terms.metaDescription || '';
            const descriptionMeta = document.getElementById('pageDescription');
            if (descriptionMeta && metaDescription) {
                descriptionMeta.setAttribute('content', metaDescription);
            }
            
            // 设置 HTML lang 属性
            const langMap = { 'zh': 'zh-CN', 'en': 'en-US', 'ja': 'ja-JP', 'ko': 'ko-KR', 'hi': 'hi-IN', 'de': 'de-DE', 'fr': 'fr-FR', 'es': 'es-ES' };
            document.getElementById('htmlRoot').setAttribute('lang', langMap[currentLang] || 'zh-CN');
        }
    </script>
    
    <!-- 4. 加载配置和工具 -->
    <script src="js/config/env.js"></script>
    <script src="js/config/supabase-config.js"></script>
    <script src="js/utils/request.js"></script>
    <script src="js/api/user.js"></script>
    
    <!-- 5. 加载组件脚本 -->
    <script src="js/components/Auth.js"></script>
    <script src="js/components/Navbar.js"></script>
    <script src="js/components/Footer.js"></script>
    <script type="module" src="js/components/LegalPage.js"></script>
    
    <!-- 6. 初始化应用 -->
    <script type="module">
        import { LegalPage } from './js/components/LegalPage.js';

        // 全局变量
        let navbar, footer, legalPage;

        // 初始化应用
        async function initApp() {
            // 1. 初始化导航栏
            navbar = new Navbar({
                container: document.getElementById('navbarContainer'),
                lang: window.LANG
            });
            await navbar.init();
            navbar.render();
            
            // 2. 渲染页脚
            footer = new Footer({
                container: document.getElementById('footerContainer'),
                lang: window.LANG
            });
            footer.render();
            footer.addBackToTopButton();
            
            // 3. 渲染法律页面
            legalPage = new LegalPage('legalContainer', window.LANG, 'terms');
            legalPage.render();
            
            // 4. 暴露到全局方便调试
            window.navbar = navbar;
            window.legalPage = legalPage;
        }

        // 启动应用
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            initApp();
        }
    </script>
</body>
</html>

