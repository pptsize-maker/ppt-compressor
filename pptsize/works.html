<!DOCTYPE html>
<html lang="zh-CN" id="htmlRoot">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags (å°†é€šè¿‡ JavaScript åŠ¨æ€è®¾ç½®) -->
    <title id="pageTitle">æˆ‘çš„ä»»åŠ¡ - pptsize</title>
    <meta name="description" content="æŸ¥çœ‹æ‚¨çš„ PPT å‹ç¼©ä»»åŠ¡åˆ—è¡¨ï¼Œä¸‹è½½å·²å®Œæˆçš„æ–‡ä»¶" id="pageDescription">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <!-- æ ·å¼ -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/works.css">
    <link rel="stylesheet" href="css/auth.css">
</head>
<body>
    <!-- å¯¼èˆªæ å®¹å™¨ -->
    <div id="navbarContainer"></div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div id="app">
        <!-- ä»»åŠ¡åˆ—è¡¨å®¹å™¨ -->
        <div id="worksContainer"></div>
    </div>

    <!-- é¡µè„šå®¹å™¨ -->
    <div id="footerContainer"></div>

    <!-- 1. åŠ è½½ç¬¬ä¸‰æ–¹åº“ -->
    <script src="js/config/supabase-js@2.js"></script>
    <script src="js/utils/axios.min.js"></script>

    <!-- 2. åŠ è½½å›½é™…åŒ–å·¥å…· -->
    <script src="js/utils/i18n.js"></script>
    
    <!-- 3. åŠ è½½è¯­è¨€åŒ… -->
    <script src="js/lang/zh.js"></script>
    <script src="js/lang/en.js"></script>
    <script src="js/lang/ja.js"></script>
    <script src="js/lang/ko.js"></script>
    <script src="js/lang/hi.js"></script>
    <script src="js/lang/de.js"></script>
    <script src="js/lang/fr.js"></script>
    <script src="js/lang/es.js"></script>
    <script>
        // ä½¿ç”¨ i18n è·å–å½“å‰è¯­è¨€å¹¶è®¾ç½®å…¨å±€è¯­è¨€å¯¹è±¡
        const currentLang = window.i18n.getCurrentLangCode();
        window.LANG = window.i18n.loadLanguage(currentLang);
        console.log('ğŸŒ å½“å‰è¯­è¨€:', currentLang);
        
        // åŠ¨æ€è®¾ç½®é¡µé¢æ ‡é¢˜å’Œæè¿°
        if (window.LANG && window.LANG.works) {
            const pageTitle = window.LANG.works.pageTitle || 'æˆ‘çš„ä»»åŠ¡';
            document.getElementById('pageTitle').textContent = `${pageTitle} - pptsize`;
            
            const metaDescription = window.LANG.works.metaDescription || '';
            const descriptionMeta = document.getElementById('pageDescription');
            if (descriptionMeta && metaDescription) {
                descriptionMeta.setAttribute('content', metaDescription);
            }
            
            // è®¾ç½® HTML lang å±æ€§
            const langMap = { 'zh': 'zh-CN', 'en': 'en-US', 'ja': 'ja-JP', 'ko': 'ko-KR', 'hi': 'hi-IN', 'de': 'de-DE', 'fr': 'fr-FR', 'es': 'es-ES' };
            document.getElementById('htmlRoot').setAttribute('lang', langMap[currentLang] || 'zh-CN');
        }
    </script>
    
    <!-- 4. åŠ è½½é…ç½®å’Œå·¥å…· -->
    <script src="js/config/env.js"></script>
    <script src="js/config/supabase-config.js"></script>
    <script src="js/utils/request.js"></script>
    <script src="js/api/user.js"></script>
    <script src="js/api/works.js"></script>
    <!-- lodash æ”¾é‡å¤ç‚¹å‡»æŒ‰é’®çš„é˜²æŠ– -->
    <script src="js/utils/lodash.min.js"></script>
    <!-- é€šç”¨ä¸‹è½½å·¥å…· -->
    <script src="js/utils/download.js"></script>
    
    <!-- 5. åŠ è½½ç»„ä»¶è„šæœ¬ -->
    <script src="js/components/Auth.js"></script>
    <script src="js/components/Navbar.js"></script>
    <script src="js/components/Footer.js"></script>
    <script type="module" src="js/components/MyWorks.js"></script>
    
    <!-- 6. åˆå§‹åŒ–åº”ç”¨ -->
    <script type="module">
        import { MyWorks } from './js/components/MyWorks.js';

        // å…¨å±€å˜é‡
        let navbar, footer, myWorks;

        // åˆå§‹åŒ–åº”ç”¨
        async function initApp() {
            console.log('ğŸ¬ åº”ç”¨å¼€å§‹åˆå§‹åŒ–...');
            
            // 1. ã€ä¼˜å…ˆã€‘åˆå§‹åŒ–å¯¼èˆªæ å’Œç”¨æˆ·è®¤è¯çŠ¶æ€
            console.log('ğŸ“ æ­¥éª¤ 1: åˆå§‹åŒ– Navbar å’Œç”¨æˆ·è®¤è¯');
            navbar = new Navbar({
                container: document.getElementById('navbarContainer'),
                lang: window.LANG
            });
            await navbar.init(); // å…ˆåˆå§‹åŒ–è®¤è¯çŠ¶æ€
            navbar.render();      // å†æ¸²æŸ“ UI
            console.log('âœ… Navbar æ¸²æŸ“å®Œæˆ');
            
            // 2. æ¸²æŸ“é¡µè„š
            console.log('ğŸ“ æ­¥éª¤ 2: åˆå§‹åŒ– Footer');
            footer = new Footer({
                container: document.getElementById('footerContainer'),
                lang: window.LANG
            });
            footer.render();
            footer.addBackToTopButton();
            console.log('âœ… Footer æ¸²æŸ“å®Œæˆ');
            
            // 3. æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨ç»„ä»¶
            console.log('ğŸ“ æ­¥éª¤ 3: åˆå§‹åŒ–ä»»åŠ¡åˆ—è¡¨ç»„ä»¶');
            myWorks = new MyWorks('worksContainer', window.LANG);
            await myWorks.render();
            console.log('âœ… ä»»åŠ¡åˆ—è¡¨ç»„ä»¶æ¸²æŸ“å®Œæˆ');
            
            // 4. æš´éœ²åˆ°å…¨å±€æ–¹ä¾¿è°ƒè¯•å’Œè·¨ç»„ä»¶è®¿é—®
            window.navbar = navbar;
            window.myWorks = myWorks;
            
            console.log('ğŸ‰ åº”ç”¨åˆå§‹åŒ–å®Œæˆ [ä¸­æ–‡ç‰ˆ]');
            console.log('-----------------------------------');
        }

        // å¯åŠ¨åº”ç”¨
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            initApp();
        }

        // é¡µé¢å¸è½½æ—¶æ¸…ç†å®šæ—¶å™¨
        window.addEventListener('beforeunload', () => {
            if (myWorks) {
                myWorks.destroy();
            }
        });
    </script>

    <!--Start of Tawk.to Script-->
        <script type="text/javascript">
        var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
        (function(){
        var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
        s1.async=true;
        s1.src='https://embed.tawk.to/6908a2aa8c8db31953f42d48/1j94rmqrq';
        s1.charset='UTF-8';
        s1.setAttribute('crossorigin','*');
        s0.parentNode.insertBefore(s1,s0);
        })();
        </script>
        <!--End of Tawk.to Script-->


</body>
</html>

